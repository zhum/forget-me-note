# forget-me-note

Проект органайзера "что где лежит". Идея работы программы - чтобы запомнить в каком ящике/столе/полке/шкафу какие вещи лежат, сфотографируйте их и отметьте вещи. Можно добавлять фото с текстом (подписью) или только текст. На фото при добавлении новой вещи необходимо отметить её рамкой. Можно добавлять иерархию - сфотографировали шкаф, затем добавили его полки (отметив их на фото шкафа), и т.д.

Формат БД:

таблица Items:

- int id             # идентификатор, primary key, uniq
- int parent         # идентификатор родителя (0 для корневого)
- string title       # подпись
- int x,y,w,h        # описание рамки на родительском фото
- int photo          # номер фотографии (0, если фото нет)
- int weight         # порядковый номер в родительском списке
- int deleted        # признак удаления
- timedate created   # время и дата создания
- timedate updated   # время и дата последнего изменения/удаления

Таблица Suggestions:

- int id             # идентификатор, primary key, uniq
- string name        # имя предлагаемого элемента
- int last           # последний номер такого элемента

Фото хранятся в одном каталоге и все имеют имя вида fmnote-XXXXXX.jpg, где XXXXXX - номер с ведущими нулями. Все фото имеют формат 3:4 (обрезается при фотографировании, пользователь выбрает что остаётся, a-la instagram).

Описание экранов прототипа с текущими соображениями:

1. Navigate

  Список из текстовых элементов, если была приложена фотография, то она отображается вверху (может быть как первый элемент списка?).
  На фото все элементы отмечены рамками. При нажатии на элемент в списке или на содержимое его рамки происходит переход на его страницу.
  Если подэлементов и фото нет, то на странице показывается только подпись (и предложение добавить фото/элементы?).
  Внизу - кнопки управления. Первая = режим. Иконку пока не придумал. При нажатии - смена списка кнопок (edit).
  Вторая - добавление, при нажатии спрашивается подпись и можно на этом закончить или добавить ещё и фото.
  После добавления фото/текста предлагается выделить на "родительском" фото расположение нового элемента (рамку) - если есть родительское фото.
  Добавленный элемент добавляется в список и на фото (если есть). Если родительского фото нет, то в конец списка, если есть, то в
  порядке сортировки на фото (сверху-вниз, слева-направо). Порядок сортировки фиксируется в БД (см. поле weight), после добавления у всех
  "потомков" это поле обновляется.
  При создании рамки действует "прилипание" - если координата угла рамки X=a и хотя бы у одного существующего потомка у одного из углов
  рамки координата X=a+d, где |d| < порога прилипания (задаётся в настройках), то a делается равным a+d. Иначе говоря, углы рамок автоматически
  выравниваются по добавленным ранее рамкам. Это должно быть отключаемо, на экране добавления рамки нужно добавить галочку "прилипание".
  Третья кнопка - переход к родителю (для корневого элемента отключена).
  Четвёртая кнопка - переход к поиску.
  
2. Edit

  Первая кнопка - режим.
  Вторая - обновление фото. Просто заново фотографируем, обрезаем, заменяем фото. Если фото нет, то добавляем.
  Третья - перемещение текущего элемента. Попадаем на экран с выбором нового родителя. После выбора родителя добавляем элемент в конец списка
  или, если у родителя есть фото, выделяем рамкой на фото положение элемента.
  4 и 5 кнопки - удаление и восстановление элемента. При удалении выбираем элементы в списке/на фото и они удаляются. При этом реальные записи и фото
  остаются, только ставится флаг 'deleted' и пересчитываются weight. При восстановлении получаем список удалённых элементов (возможно стоит
  сделать выбор - все/только для этого "родителя"), выбранные элементы восстанавливаются, значения weight пересчитываются.
  6 кнопка - режим перетаскивания элементов в списке, можно менять их порядок (пересчитываются weight). Для последнего выделенного элемента
  можно менять его рамку на фото.

3. Preferences

  Настройки:

  - цвет рамки
  - порог прилипания
  - список имён, предлагаемых при добавлении
  - кнопка "стереть удалённые" (все удалённые элементы и их фото удаляются совсем)
  - кнопка export - БД экспортируется в csv и вместе со всеми фото архивируется в zip
  - кнопка import - импорт из zip, старые данные удаляются
  - кнопка import add - добавление новых элементов из zip как потомка (выбирается его родитель и подпись)
  
В режиме поиска доступен иерархичекский список всего, а также режим "все фото" - их можно листать (а лучше проматывать, имея перед глазами  ~5 фото).
В режиме "все фото" не забыть про отображение подписей.
При добавлении элемента можно ввести подпись вручную, а можно выбрать из выпадающего списка (и отредактивать потом). Например, по умолчанию
в списке будут "Комната 1", "Шкаф 1", "Полка 1". Если пользователь выбирает "Комната 1", он может отректировать это имя. Если он оставляет его
таким же, то в следующий раз в списке будет "Комната 2". Если пользователь удаляет элемент, то производится проверка, не нужно ли скорректировать
номер последнего предложения (например, добавили "Комната 5", а потом удалили, в списке снова появится "Комната 5", вместо 6).



  
  
  
  